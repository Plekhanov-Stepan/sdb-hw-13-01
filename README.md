# Домашнее задание к занятию «Уязвимости и атаки на информационные системы» - Плеханов С.А.

### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
*Приведите ответ в свободной форме.*

### Решение 1  

На исследуемой машине разрешены следующие сетевые службы:

<img src = "img/Screenshot_1_1.png" width=100%>

<img src = "img/Screenshot_1_2.png" width=100%>

Для указанных сетевых служб характерны следующие уязвимоости в качестве примера:

[ZeroShell 3.9.0 - Remote Command Execution](https://www.exploit-db.com/exploits/49862)

[uftpd 2.10 - Directory Traversal (Authenticated)](https://www.exploit-db.com/exploits/51000)

[MySQL User-Defined (Linux) x32 / x86\_64 - 'sys\_exec' Local Privilege Escalation (2)](https://www.exploit-db.com/exploits/50236)



### Задание 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
- Как отвечает сервер?

*Приведите ответ в свободной форме.*

### Решение 2

В режиме SYN получилось просканировать все порты и определить открытые за 0.51 секунду.

<img src = "img/Screenshot_2_1.png" width=100%>

В режиме SYN программа nmap не устанавливает полного TCP соединения, а делает выводы по реакции хоста на запрос SYN. Т.е. если пришел ответ SYN/ACK - это указывают на то, что порт прослушивается (открыт), а RST (сброс) на то, что не прослушивается. Если после нескольких запросов не приходит никакого ответа, то порт помечается как фильтруемый. 



Когда сканируется система отвечающая требованиям RFC, любой пакет, не содержащий установленного бита SYN, RST или ACK, повлечет за собой отправку RST в ответ в случае, если порт закрыт, или не повлечет никакого ответа, если порт открыт. Т.к. ни один из этих битов не установлен, то любая комбинация трех оставшихся (FIN, PSH и URG) будет являться правильной. nmap использует это в трех типах сканирования:


FIN сканирование (-sF)
Устанавливается только TCP FIN бит.

Xmas сканирование (-sX)
Устанавливаются FIN, PSH и URG флаги.

Эти типы сканирования работают по одной схеме, различия только в TCP флагах установленных в пакетах запросов. Если в ответ приходит RST пакет, то порт считается закрытым, отсутствие ответа означает, что порт открыт или фильтруется.

В режиме FIN получилось просканировать все порты и определить открытые за 0.40 секунд, но при этом открытые порты определены не были.

<img src = "img/Screenshot_2_2.png" width=100%>



В режиме Xmas получилось просканировать все порты и определить открытые за 1.86 секунды, хотя размер запросов и ответов примерноо одинаков и при этом количество перехваченных пакетов также примерно одинаково.

<img src = "img/Screenshot_2_3.png" width=100%>

В режиме UDP сканирование происходит непрерывно и завеершения процесса не наступает, хотя Wireshark показывает постоянное прохождение запросов-ответов через наблюдаемый интерфейс.

<img src = "img/Screenshot_2_4.png" width=100%>

На виртуальной машине Ubuntu установлены Wireshark и nmap.

Исследуемая машина Metasploitable имеет адрес: 192.168.0.222

<img src = "img/Screenshot_2_7.png" width=100%>

Адрес машины с nmap 192.168.0.210 на интерфейсе enp0s8:

<img src = "img/Screenshot_2_6.png" width=100%>

Wireshark запускается на прослушивание порта enp0s8:

<img src = "img/Screenshot_2_5.png" width=100%>

В терминале запускается команда $sudo nmap -sX 192.168.0.222

<img src = "img/Screenshot_2_8.png" width=100%>

В результате Wireshark перехватывает около 2000 пакетоов:

<img src = "img/Screenshot_2_9.png" width=100%>
